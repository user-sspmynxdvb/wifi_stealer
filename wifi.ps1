(netsh wlan show profiles) | Select-String "\:(.+)$" | ForEach-Object {$name = $_.Matches.Groups[1].Value.Trim(); (netsh wlan show profile name="$name" key=clear)} | Select-String "(Содержимое ключа|Key Content)\W*\:(.+)$" | ForEach-Object {$pass = $_.Matches.Groups[2].Value.Trim(); [PSCustomObject]@{NAME = $name; PASSWORD = $pass}} | Format-Table -AutoSize | Out-String > wifi.txt
